!function(t){var e={};function n(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(i,a,function(e){return t[e]}.bind(null,a));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}n.r(e);var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.imageFiles=e,this.images={}}var e,n,a;return e=t,(n=[{key:"load",value:function(){var t=[];for(var e in this.imageFiles)t.push(this.loadImage(e,this.imageFiles[e]));return Promise.all(t)}},{key:"loadImage",value:function(t,e){var n=this;return new Promise(function(i){var a=new Image;n.images[t]=a,a.onload=function(){return i(t)},a.src=e})}}])&&i(e.prototype,n),a&&i(e,a),t}();function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var r=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.width=e,this.height=n,this.canvas=this.createCanvas(e,n),this.context=this.canvas.getContext("2d"),this.images={},this.isImagesLoaded=!1,this.glWidth=window.innerWidth>window.innerHeight?window.innerHeight:window.innerWidth,this.canvas.style.top=window.innerWidth>window.innerHeight?0:"auto",this.canvas.style.width=this.glWidth+"px",this.canvas.style.height=this.glWidth+"px",this.scale=window.devicePixelRatio*window.devicePixelRatio,this.context.scale(this.scale,this.scale),this.canvas.width=this.glWidth*this.scale,this.canvas.height=this.glWidth*this.scale,this.scaleFonts=window.devicePixelRatio*window.devicePixelRatio==1?2:window.devicePixelRatio*window.devicePixelRatio}var e,n,i;return e=t,(n=[{key:"loadImages",value:function(t){var e=this,n=new a(t);n.load().then(function(t){e.images=Object.assign(e.images,n.images),e.isImagesLoaded=!0})}},{key:"createCanvas",value:function(t,e){var n=document.getElementsByTagName("canvas")[0]||document.createElement("canvas");return document.body.appendChild(n),n.width=t,n.height=e,n}},{key:"fill",value:function(t){this.context.fillStyle=t,this.context.fillRect(0,0,this.canvas.width,this.canvas.height)}},{key:"print",value:function(t,e,n){this.context.fillStyle="#FFFFFF",this.context.font=18*this.scaleFonts+"px Georgia",this.context.textAlign="center",this.context.fillText(n,t,e)}},{key:"drawImage",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;0!=i&&0!=a?this.context.drawImage(this.images[n],t,e,i,a):this.context.drawImage(this.images[n],t,e)}}])&&o(e.prototype,n),i&&o(e,i),t}();function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.game=e,this.status=this.constructor.WORKING}var e,n,i;return e=t,i=[{key:"WORKING",get:function(){return"WORKING"}},{key:"LOADED",get:function(){return"LOADED"}},{key:"START_GAME",get:function(){return"START_GAME"}},{key:"GAME_OVER",get:function(){return"GAME_OVER"}},{key:"GAME_WIN",get:function(){return"GAME_WIN"}},{key:"FINISHED",get:function(){return"FINISHED"}}],(n=[{key:"init",value:function(){this.status=this.constructor.WORKING}},{key:"finish",value:function(t){this.status=t}},{key:"render",value:function(t){}}])&&s(e.prototype,n),i&&s(e,i),t}();function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function u(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(t,e,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=m(t)););return t}(t,e);if(i){var a=Object.getOwnPropertyDescriptor(i,e);return a.get?a.get.call(n):a.value}})(t,e,n||t)}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var g=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=u(this,m(e).call(this,t))).loadedAt=0,n}var n,i,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(e,h),n=e,(i=[{key:"init",value:function(){f(m(e.prototype),"init",this).call(this),this.loadedAt=0}},{key:"update",value:function(t){0==this.loadedAt&&1==this.game.screen.isImagesLoaded&&(this.loadedAt=t),0!=this.loadedAt&&t-this.loadedAt>500&&this.finish(h.LOADED)}},{key:"render",value:function(t){this.update(t),this.game.screen.fill("#000000"),this.game.screen.print(this.game.screen.canvas.width/2,this.game.screen.canvas.width/2,"Загрузка..."),f(m(e.prototype),"render",this).call(this,t)}}])&&l(n.prototype,i),a&&l(n,a),e}();function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function v(t,e){return!e||"object"!==d(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function b(t,e,n){return(b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=w(t)););return t}(t,e);if(i){var a=Object.getOwnPropertyDescriptor(i,e);return a.get?a.get.call(n):a.value}})(t,e,n||t)}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function O(t,e){return(O=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var k=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=v(this,w(e).call(this,t))).canvas=document.getElementsByTagName("canvas")[0],n}var n,i,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&O(t,e)}(e,h),n=e,(i=[{key:"init",value:function(){b(w(e.prototype),"init",this).call(this)}},{key:"update",value:function(t){this.game.control.clickX>=(this.game.screen.canvas.width/2-this.game.screen.canvas.width/4)/this.game.screen.scale&&this.game.control.clickX<=(this.game.screen.canvas.width/2+this.game.screen.canvas.width/4)/this.game.screen.scale&&this.game.control.clickY>=(this.game.screen.canvas.width/2-this.game.screen.canvas.width/4)/this.game.screen.scale&&this.game.control.clickY<=(this.game.screen.canvas.width/2+this.game.screen.canvas.width/4)/this.game.screen.scale&&(this.game.control.back(),this.finish(h.START_GAME))}},{key:"render",value:function(t){this.update(t),this.game.screen.drawImage(0,0,"fon",this.canvas.width,this.canvas.height),this.game.screen.print(this.game.screen.canvas.width/2,this.game.screen.canvas.width/2,"Новая игра"),this.game.screen.print(this.game.screen.canvas.width/2,.9*this.game.screen.canvas.width,"© 48World, 2019"),b(w(e.prototype),"render",this).call(this,t)}}])&&y(n.prototype,i),a&&y(n,a),e}();function j(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var x=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.game=e}var e,n,i;return e=t,(n=[{key:"init",value:function(){}},{key:"render",value:function(t){for(var e=0;e<9;e++)for(var n=0;n<9;n++)""!=this.game.model.objs[e][n]&&this.game.screen.drawImage(this.game.model.objs[e][n].x,this.game.model.objs[e][n].y,this.game.model.objs[e][n].color,this.game.model.objs[e][n].w,this.game.model.objs[e][n].h)}}])&&j(e.prototype,n),i&&j(e,i),t}();var P=function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color=i,this.canvas=document.getElementsByTagName("canvas")[0],this.w=this.canvas.width/9,this.h=this.canvas.height/9,this.x=this.w*e,this.y=this.h*n,this.action=!1,this.ActAnimStep=0,this.path=[],this.pathlink=[]};function A(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var E=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.objs=[];for(var e=0;e<9;e++){this.objs[e]=[];for(var n=0;n<9;n++)this.objs[e][n]=""}this.entryPlayer=[],this.entryPlayers=0,this.action=[]}var e,n,i;return e=t,(n=[{key:"clear",value:function(){for(var t=0;t<9;t++)for(var e=0;e<9;e++)this.objs[t][e]=""}},{key:"newGameObj",value:function(t,e,n){return new P(t,e,n)}},{key:"clearAction",value:function(){for(var t=0;t<9;t++)for(var e=0;e<9;e++)""!=this.objs[t][e]&&this.objs[t][e].action&&(this.objs[t][e].action=!1)}},{key:"ActionChange",value:function(t,e){for(var n=0;n<9;n++)for(var i=0;i<9;i++)""!=this.objs[n][i]&&this.objs[n][i].action&&(this.objs[e][t]=new P(t,e,this.objs[n][i].color),this.objs[n][i]="")}},{key:"deleteAction",value:function(){for(var t=0;t<9;t++)for(var e=0;e<9;e++)""!=this.objs[t][e]&&this.objs[t][e].action&&(this.objs[t][e]="")}},{key:"whoAction",value:function(){for(var t=0;t<9;t++)for(var e=0;e<9;e++)if(""!=this.objs[t][e]&&this.objs[t][e].action)return this.objs[t][e]}},{key:"randomInteger",value:function(t,e){var n=t+Math.random()*(e+1-t);return n=Math.floor(n)}},{key:"emptyObj",value:function(){this.entryPlayers=0,this.entryPlayer=[];for(var t=0;t<9;t++)for(var e=0;e<9;e++)""==this.objs[t][e]&&(this.entryPlayer[this.entryPlayers]=[t,e],this.entryPlayers++);return this.entryPlayers}},{key:"rndAddObj",value:function(){if(this.emptyObj(),this.entryPlayers>0){for(var t=[],e=this.entryPlayers>2?3:1,n=0;n<e;n++){var i=this.randomInteger(0,this.entryPlayers-1);-1==t.indexOf(i)?t[n]=i:n--}for(var a=0;a<t.length;a++)this.objs[this.entryPlayer[t[a]][0]][this.entryPlayer[t[a]][1]]=new P(this.entryPlayer[t[a]][1],this.entryPlayer[t[a]][0],"c"+this.randomInteger(1,7));return t}return 0}}])&&A(e.prototype,n),i&&A(e,i),t}();function S(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var _=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.game=e,this.loadedAt=0}var e,n,i;return e=t,(n=[{key:"update",value:function(t){if(0==this.loadedAt&&(this.loadedAt=t),0!=this.loadedAt&&t-this.loadedAt>12){if(this.game.model.action.length>0){var e=Math.sin(this.game.model.objs[this.game.model.action[0]][this.game.model.action[1]].ActAnimStep);this.game.model.objs[this.game.model.action[0]][this.game.model.action[1]].ActAnimStep=this.game.model.objs[this.game.model.action[0]][this.game.model.action[1]].ActAnimStep+.3,this.game.model.objs[this.game.model.action[0]][this.game.model.action[1]].y=this.game.model.objs[this.game.model.action[0]][this.game.model.action[1]].y+e*this.game.scaleAnim}this.loadedAt=0}}}])&&S(e.prototype,n),i&&S(e,i),t}();function R(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var I=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.path=[],this.pathlink=[],this.open=[],this.close=[],this.noda=0,this.game=e,this.canvas=document.getElementsByTagName("canvas")[0],this.w=this.canvas.width/9,this.h=this.canvas.height/9}var e,n,i;return e=t,(n=[{key:"nodaCheck",value:function(t){var e=this.open[t][0],n=this.open[t][1],i=e+1<9?this.game.model.objs[e+1][n]:-1,a=e-1>=0?this.game.model.objs[e-1][n]:-1,o=n-1>=0?this.game.model.objs[e][n-1]:-1,r=n+1<9?this.game.model.objs[e][n+1]:-1;-1==this.close.indexOf(e+","+n)?(0==i&&-1==this.close.indexOf(e+1+","+n)&&-1==this.path.indexOf(e+1+","+n)&&(this.path[this.path.length]=e+1+","+n,this.pathlink[this.pathlink.length]=e+","+n,this.open[this.open.length]=[e+1,n]),0==a&&-1==this.close.indexOf(e-1+","+n)&&-1==this.path.indexOf(e-1+","+n)&&(this.path[this.path.length]=e-1+","+n,this.pathlink[this.pathlink.length]=e+","+n,this.open[this.open.length]=[e-1,n]),0==o&&-1==this.close.indexOf(e+","+(n-1))&&-1==this.path.indexOf(e+","+(n-1))&&(this.path[this.path.length]=e+","+(n-1),this.pathlink[this.pathlink.length]=e+","+n,this.open[this.open.length]=[e,n-1]),0==r&&-1==this.close.indexOf(e+","+(n+1))&&-1==this.path.indexOf(e+","+(n+1))&&(this.path[this.path.length]=e+","+(n+1),this.pathlink[this.pathlink.length]=e+","+n,this.open[this.open.length]=[e,n+1]),this.open[t][0]==e&&this.open[t][1]==n&&(this.close[this.close.length]=e+","+n,this.open.splice(t,1))):this.open.splice(t,1)}},{key:"findPath",value:function(t,e){for(this.path=[],this.pathlink=[],this.open=[],this.close=[],this.noda=0,this.open[0]=[t,e];this.open.length>0;)this.nodaCheck(0);this.game.model.path=this.path,this.game.model.pathlink=this.pathlink}},{key:"pathCheck",value:function(){return this.path}},{key:"clear",value:function(){this.path=[],this.pathlink=[],this.open=[],this.close=[],this.noda=0}},{key:"pathFinish",value:function(t){function e(e,n,i,a){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t,e,n,i){for(pathFinish=[],playerTemp=players[t][e],players[t][e]=0,xft=n,yft=i,pathFinish[pathFinish.length]=[n,i];t+","+e!=pathlink[a];){var a=path.indexOf(n+","+i);pathlink[a].indexOf(",");var o=parseInt(pathlink[a].substring(0,pathlink[a].indexOf(","))),r=parseInt(pathlink[a].slice(pathlink[a].indexOf(",")+1));n=o,i=r,pathFinish[pathFinish.length]=[o,r]}return pathFinish})},{key:"render",value:function(t){for(var e=0;e<this.path.length;e++){this.path[e].indexOf(",");var n=parseInt(this.path[e].substring(0,this.path[e].indexOf(","))),i=parseInt(this.path[e].slice(this.path[e].indexOf(",")+1));this.game.screen.drawImage(i*this.h,n*this.w,"path",this.w,this.h)}}}])&&R(e.prototype,n),i&&R(e,i),t}();function T(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var C=function(){function t(e,n,i,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.game=e,this.obj=n,this.xs=this.game.control.getCell(n.x,n.y)[0],this.ys=this.game.control.getCell(n.x,n.y)[1],this.xf=i,this.yf=a,this.xft=this.xf,this.yft=this.yf,this.pathFinish=[],this.pathArr(),this.step=this.pathFinish.length-1,this.loadedAt=0}var e,n,i;return e=t,(n=[{key:"pathArr",value:function(){this.pathFinish[0]=[this.xf,this.yf];for(var t=this.game.model.path.indexOf(this.yf+","+this.xf);-1!=t;){var e=parseInt(this.game.model.pathlink[t].substring(0,this.game.model.pathlink[t].indexOf(","))),n=parseInt(this.game.model.pathlink[t].slice(this.game.model.pathlink[t].indexOf(",")+1));this.xf=n,this.yf=e,this.pathFinish[this.pathFinish.length]=[n,e],t=this.game.model.path.indexOf(this.yf+","+this.xf)}}},{key:"update",value:function(t){0==this.loadedAt&&(this.loadedAt=t),0!=this.loadedAt&&t-this.loadedAt>12&&(this.game.model.objs[this.yft][this.xft].x=this.pathFinish[this.step][0]*this.game.screen.canvas.width/9,this.game.model.objs[this.yft][this.xft].y=this.pathFinish[this.step][1]*this.game.screen.canvas.height/9,this.step--,this.step<0&&(this.game.pathAnim="",this.game.likeControl.check()||this.game.model.rndAddObj()),this.loadedAt=0)}},{key:"render",value:function(t){this.update(t)}}])&&T(e.prototype,n),i&&T(e,i),t}();function F(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var G=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.game=e,this.matrix=[["0,0","0,1","0,2","0,3","0,4","0,5","0,6","0,7","0,8"],["1,0","1,1","1,2","1,3","1,4","1,5","1,6","1,7","1,8"],["2,0","2,1","2,2","2,3","2,4","2,5","2,6","2,7","2,8"],["3,0","3,1","3,2","3,3","3,4","3,5","3,6","3,7","3,8"],["4,0","4,1","4,2","4,3","4,4","4,5","4,6","4,7","4,8"],["5,0","5,1","5,2","5,3","5,4","5,5","5,6","5,7","5,8"],["6,0","6,1","6,2","6,3","6,4","6,5","6,6","6,7","6,8"],["7,0","7,1","7,2","7,3","7,4","7,5","7,6","7,7","7,8"],["8,0","8,1","8,2","8,3","8,4","8,5","8,6","8,7","8,8"],["0,0","1,0","2,0","3,0","4,0","5,0","6,0","7,0","8,0"],["0,1","1,1","2,1","3,1","4,1","5,1","6,1","7,1","8,1"],["0,2","1,2","2,2","3,2","4,2","5,2","6,2","7,2","8,2"],["0,3","1,3","2,3","3,3","4,3","5,3","6,3","7,3","8,3"],["0,4","1,4","2,4","3,4","4,4","5,4","6,4","7,4","8,4"],["0,5","1,5","2,5","3,5","4,5","5,5","6,5","7,5","8,5"],["0,6","1,6","2,6","3,6","4,6","5,6","6,6","7,6","8,6"],["0,7","1,7","2,7","3,7","4,7","5,7","6,7","7,7","8,7"],["0,8","1,8","2,8","3,8","4,8","5,8","6,8","7,8","8,8"],["0,4","1,5","2,6","3,7","4,8"],["0,3","1,4","2,5","3,6","4,7","5,8"],["0,2","1,3","2,4","3,5","4,6","5,7","6,8"],["0,1","1,2","2,3","3,4","4,5","5,6","6,7","7,8"],["0,0","1,1","2,2","3,3","4,4","5,5","6,6","7,7","8,8"],["1,0","2,1","3,2","4,3","5,4","6,5","7,6","8,7"],["2,0","3,1","4,2","5,3","6,4","7,5","8,6"],["3,0","4,1","5,2","6,3","7,4","8,5"],["4,0","5,1","6,2","7,3","8,4"],["0,4","1,3","2,2","3,1","4,0"],["0,5","1,4","2,3","3,2","4,1","5,0"],["0,6","1,5","2,4","3,3","4,2","5,1","6,0"],["0,7","1,6","2,5","3,4","4,3","5,2","6,1","7,0"],["0,8","1,7","2,6","3,5","4,4","5,3","6,2","7,1","8,0"],["1,8","2,7","3,6","4,5","5,4","6,3","7,2","8,1"],["2,8","3,7","4,6","5,5","6,4","7,3","8,2"],["3,8","4,7","5,6","6,5","7,4","8,3"],["4,8","5,7","6,6","7,5","8,4"]]}var e,n,i;return e=t,(n=[{key:"check_line",value:function(t){for(var e=this.matrix[t],n=[],i="",a=!1,o=0;o<e.length;o++){var r=parseInt(e[o].substring(0,e[o].indexOf(","))),s=parseInt(e[o].slice(e[o].indexOf(",")+1));if(""!=this.game.model.objs[r][s])if(""!==i)if(i==this.game.model.objs[r][s].color)n[n.length]=[r,s];else if(n.length<5)(n=[])[0]=[r,s],i=this.game.model.objs[r][s].color;else{for(var h=0;h<n.length;h++)this.game.model.objs[n[h][0]][n[h][1]]="",a=!0;n=[],i=""}else i=this.game.model.objs[r][s].color,n[0]=[r,s];else if(n.length>=5){for(var c=0;c<n.length;c++)this.game.model.objs[n[c][0]][n[c][1]]="",a=!0;n=[],i=""}else n=[],i=""}if(n.length>=5){for(var l=0;l<n.length;l++)this.game.model.objs[n[l][0]][n[l][1]]="",a=!0;n=[],i=""}return a}},{key:"check",value:function(){for(var t=!1,e=0;e<this.matrix.length;e++)t=!!this.check_line(e)||t;return t}}])&&F(e.prototype,n),i&&F(e,i),t}();function W(t){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function M(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function L(t,e){return!e||"object"!==W(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function X(t,e,n){return(X="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=D(t)););return t}(t,e);if(i){var a=Object.getOwnPropertyDescriptor(i,e);return a.get?a.get.call(n):a.value}})(t,e,n||t)}function D(t){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Y(t,e){return(Y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var N=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=L(this,D(e).call(this,t))).game.scale=window.devicePixelRatio*window.devicePixelRatio,n.game.scaleAnim=window.devicePixelRatio*window.devicePixelRatio==1?2:window.devicePixelRatio*window.devicePixelRatio/2,n.game.glWidth=window.innerWidth>window.innerHeight?window.innerHeight:window.innerWidth,n.canvas=document.getElementsByTagName("canvas")[0],n}var n,i,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Y(t,e)}(e,h),n=e,(i=[{key:"init",value:function(){X(D(e.prototype),"init",this).call(this),this.game.model=new E(this.game),this.game.gameObjsRender=new x(this.game),this.game.animator=new _(this.game),this.game.model.rndAddObj(),this.game.pathFinder=new I(this.game),this.game.pathAnim="",this.game.likeControl=new G(this.game)}},{key:"update",value:function(t){if(""!=this.game.pathAnim?this.game.control.back():this.game.likeControl.check(),-1!=this.game.control.cellX){if(""!=this.game.model.objs[this.game.control.cellY][this.game.control.cellX])this.game.model.action=[this.game.control.cellY,this.game.control.cellX],this.game.pathFinder.findPath(this.game.control.cellY,this.game.control.cellX);else{if(this.game.model.action.length>0)var e=this.game.model.objs[this.game.model.action[0]][this.game.model.action[1]];else e="";""!=e&&this.game.model.path.indexOf(this.game.control.cellY+","+this.game.control.cellX)>-1&&(this.game.model.objs[this.game.control.cellY][this.game.control.cellX]=this.game.model.newGameObj(this.game.model.action[1],this.game.model.action[0],e.color),this.game.model.objs[this.game.model.action[0]][this.game.model.action[1]]="",this.game.pathAnim=new C(this.game,this.game.model.objs[this.game.control.cellY][this.game.control.cellX],this.game.control.cellX,this.game.control.cellY),this.game.model.action=[],this.game.model.path=[],this.game.model.pathlink=[],e="")}this.game.control.back()}0==this.game.model.emptyObj()&&this.finish(h.GAME_OVER)}},{key:"render",value:function(t){this.game.screen.drawImage(0,0,"fon",this.canvas.width,this.canvas.height),this.update(t),this.game.gameObjsRender.render(t),this.game.model.action.length>0&&this.game.pathFinder.render(t),this.game.animator.update(t),""!=this.game.pathAnim&&this.game.pathAnim.render(t),X(D(e.prototype),"render",this).call(this,t)}}])&&M(n.prototype,i),a&&M(n,a),e}();function H(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var B=function(){function t(e,n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.clickX=-1,this.clickY=-1,this.canvas=e,this.canvas.addEventListener("click",function(t){return i.update(t)}),this.LWCanvas=this.canvas.width/9/n.screen.scale,this.LHCanvas=this.canvas.height/9/n.screen.scale}var e,n,i;return e=t,(n=[{key:"update",value:function(t){this.clickX=t.offsetX,this.clickY=t.offsetY,this.cellX=~~(this.clickX/this.LWCanvas),this.cellY=~~(this.clickY/this.LHCanvas)}},{key:"getCell",value:function(t,e){return[~~(t/this.LWCanvas),~~(e/this.LHCanvas)]}},{key:"back",value:function(){this.clickX=-1,this.clickY=-1,this.cellX=-1,this.cellY=-1}}])&&H(e.prototype,n),i&&H(e,i),t}();function K(t){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function V(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function q(t,e){return!e||"object"!==K(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function z(t,e,n){return(z="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=J(t)););return t}(t,e);if(i){var a=Object.getOwnPropertyDescriptor(i,e);return a.get?a.get.call(n):a.value}})(t,e,n||t)}function J(t){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Q(t,e){return(Q=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var U=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=q(this,J(e).call(this,t))).loadedAt=0,n.GOtimer=2e3,n}var n,i,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Q(t,e)}(e,h),n=e,(i=[{key:"init",value:function(){z(J(e.prototype),"init",this).call(this),this.loadedAt=0}},{key:"update",value:function(t){0==this.loadedAt&&(this.loadedAt=t),0!=this.loadedAt&&t-this.loadedAt>this.GOtimer&&this.finish(h.LOADED),this.darkness=(t-this.loadedAt)/this.GOtimer/10}},{key:"render",value:function(t){this.update(t),this.game.screen.fill("rgba(0, 0, 0, ".concat(this.darkness,")")),this.game.screen.print(this.game.screen.canvas.width/2,this.game.screen.canvas.width/2,"GAME OVER"),z(J(e.prototype),"render",this).call(this,t)}}])&&V(n.prototype,i),a&&V(n,a),e}();function Z(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var $=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.width,i=void 0===n?640:n,a=e.height,o=void 0===a?640:a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.screen=new r(i,o),this.screen.loadImages({c1:"./img/1.png",c2:"./img/2.png",c3:"./img/3.png",c4:"./img/4.png",c5:"./img/5.png",c6:"./img/6.png",c7:"./img/7.png",fon:"./img/fon.png",path:"./img/path.png"}),this.control=new B(this.screen.canvas,this),this.scenes={loading:new g(this),menu:new k(this),gameLevel:new N(this),gameOver:new U(this)},this.currentScene=this.scenes.loading,this.currentScene.init()}var e,n,i;return e=t,(n=[{key:"changeScene",value:function(t){switch(t){case h.LOADED:return this.scenes.menu;case h.START_GAME:return this.scenes.gameLevel;case h.GAME_OVER:return this.scenes.gameOver;default:return this.scenes.menu}}},{key:"frame",value:function(t){var e=this;this.currentScene.status!=h.WORKING&&(this.currentScene=this.changeScene(this.currentScene.status),this.currentScene.init()),this.currentScene.render(t),requestAnimationFrame(function(t){return e.frame(t)})}},{key:"run",value:function(){var t=this;requestAnimationFrame(function(e){return t.frame(e)})}}])&&Z(e.prototype,n),i&&Z(e,i),t}();window.onload=function(){(new $).run()}}]);